
Original code by analog_hors + cache to file:
Memory usage:
~8.8GiB for 1000 objects
~34GiB until new objects

New code v1 (with checking for repeats + priority queue + cache to file):
7.6GiB for 1000 objects
~20GiB until new objects (maybe the ordering is important though)